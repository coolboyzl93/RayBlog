<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			#div1 {
				height: 200px;
				width: 400px box-shadow: 0px 0px 10px 0px gray;
				background-color: greenyellow;
				color: white;
				font-size: 36px;
			}
			
			#move {
				width: 100px;
				height: 100px;
				border-radius: 50%;
				background-color: royalblue;
				margin-top: 20px;
				position: relative;
				animation: play 10s alternate infinite linear;
			}
			
			@keyframes play {
				from {
					left: 0px;
				}
				to {
					left: 90%;
				}
			}
		</style>
	</head>

	<body>
		<!--写在前面：
			ajax的意义就是异步加载，就是能够异步地改变页面的内容，
			所以一定至少有两个文件，一个是展示页面的文件，另一个是向展示页面输送额外内容的文件，
			当然也可以是多个输送页面。
			输送页面的文件类型(暂时知道的)：
			1.txt
			2.html
			3.json
			4.asp
			5.php
		-->
		<div>
			<table border="3">
				<caption>properties&methods of XHR_obj</caption>
				<tr>
					<td>onreadystatechange</td>
					<td></td>
				</tr>
				<tr>
					<td>readyState</td>
					<td></td>
				</tr>
				<tr>
					<td>status</td>
					<td></td>
				</tr>
				<tr>
					<td>responseText</td>
					<td></td>
				</tr>
				<tr>
					<td>responseXML</td>
					<td></td>
				</tr>
				<tr>
					<td>open(method,url,ture)</td>
					<td></td>
				</tr>
				<tr>
					<td>send()</td>
					<td></td>
				</tr>
				<tr>
					<td>setRequestHeader(header,value)</td>
					<td></td>
				</tr>

			</table>
		</div>
		</-->
		<div>
			use animation to comfirm the page hasn't been reload
		</div>
		<div id="move"></div>
		<button class="btn">点击发送AJAX请求,获取html数据</button>
		<button class="btn">点击发送AJAX请求,获取txt数据</button>
		<button class="btn">点击发送AJAX请求,获取JSON数据</button>
		
		<br />
		<br />
		<div id="div1">

		</div>

	</body>
	<script type="text/javascript">
		var btn = document.getElementsByClassName("btn");
		var div1 = document.getElementById("div1");
		var datas = ["serverData1.html", "serverData2.txt", "serverData3.json"];

		//step1: create XMLHttpRequest object

		//		var XHR_obj= new XMLHttpRequest();//usually
		//compatible with IE6 and below
		var XHR_obj;
		if(window.XMLHttpRequest) {
			XHR_obj = new XMLHttpRequest();
		} else {
			XHR_obj = new ActiveXObject("Microsoft.XMLHTTP");
		}

		//step2:monitor the property('readyState') of XMLHttpRequest object 

		//here is a property 'onreadystatechange'used to store functions triggered->
		//->by the change of 'readyState',here we go!
		// In this step,we usually deliver the data form server to DOM.  
		XHR_obj.onreadystatechange = function() {

			if(XHR_obj.readyState == 4 && XHR_obj.status == 200) {
				//				
				if(isJSON(XHR_obj.responseText)) {
					div1.innerHTML = JSON.parse(XHR_obj.responseText).employees[0].firstName;
				} else {
					div1.innerHTML = XHR_obj.responseText
				};
			}

		}
		//step3:define and send requests of XHR_obj

		for(var i = 0; i < btn.length; i++) {

			- function(i) {

				btn[i].onclick = function() {
					XHR_obj.open("GET", datas[i], true);
					XHR_obj.send();
				}
			}(i)
		}

		function isJSON(str) {
			if(typeof str == 'string') {
				try {
					JSON.parse(str);
					return true;
				} catch(e) {
					console.log(e);
					return false;
				}
			}
			console.log('It is not a string!')
		}
		//当使用JSON文件进行数据传递的时候，此时传入的responseText也是一个字符串，需要使用JSON.parse()解析成JSON对象。
	</script>
<!--record:2017/6/1 3:21
	1关于JSON字符串怎样识别出JSON数据?
	(1)这里用的isJSON函数 (2)使用正则去判断JSON数据。
	
	2关于PHP文件 和ASP文件的相关知识?
	....
	
	3关于responseXML的用法
	
	4关于setRequstHeader()的用法。
-->
</html>